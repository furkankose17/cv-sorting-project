<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:suite="sap.suite.ui.commons">

    <Dialog
        id="timelineDialog"
        title="Candidate Timeline - {dialogModel>/candidateName}"
        contentWidth="700px"
        contentHeight="80%"
        resizable="true"
        draggable="true">

        <content>
            <VBox class="sapUiSmallMargin">
                <!-- Filter Options -->
                <Toolbar>
                    <Label text="Filter by Event Type:" />
                    <SegmentedButton
                        id="timelineFilterSegment"
                        selectionChange=".onTimelineFilterChange"
                        selectedKey="{dialogModel>/selectedFilter}">
                        <items>
                            <SegmentedButtonItem key="all" text="All" />
                            <SegmentedButtonItem key="status" text="Status Changes" />
                            <SegmentedButtonItem key="interview" text="Interviews" />
                            <SegmentedButtonItem key="document" text="Documents" />
                            <SegmentedButtonItem key="note" text="Notes" />
                        </items>
                    </SegmentedButton>
                    <ToolbarSpacer />
                    <Button
                        icon="sap-icon://refresh"
                        tooltip="Refresh Timeline"
                        press=".onRefreshTimeline" />
                </Toolbar>

                <!-- Loading Indicator -->
                <BusyIndicator
                    id="timelineBusyIndicator"
                    visible="{dialogModel>/isLoading}"
                    class="sapUiMediumMarginTop sapUiMediumMarginBottom" />

                <!-- Timeline -->
                <suite:Timeline
                    id="candidateTimeline"
                    visible="{= !${dialogModel>/isLoading} }"
                    enableDoubleSided="true"
                    groupBy="eventType"
                    sortOldestFirst="false"
                    content="{dialogModel>/timelineEvents}">

                    <suite:TimelineItem
                        dateTime="{dialogModel>timestamp}"
                        title="{dialogModel>title}"
                        text="{dialogModel>description}"
                        userName="{dialogModel>userName}"
                        userNameClickable="false"
                        icon="{
                            path: 'dialogModel>eventType',
                            formatter: '.formatTimelineIcon'
                        }"
                        filterValue="{dialogModel>eventType}">

                        <suite:customAction>
                            <Button
                                icon="sap-icon://detail-view"
                                type="Transparent"
                                tooltip="View Details"
                                press=".onTimelineEventDetails"
                                visible="{= ${dialogModel>hasDetails} === true }" />
                        </suite:customAction>

                        <suite:suggestionItems>
                            <core:Item text="{dialogModel>details}" />
                        </suite:suggestionItems>
                    </suite:TimelineItem>
                </suite:Timeline>

                <!-- Empty State -->
                <IllustratedMessage
                    illustrationType="sapIllus-NoData"
                    title="No Timeline Events"
                    description="No events found for this candidate"
                    visible="{= !${dialogModel>/isLoading} &amp;&amp; ${dialogModel>/timelineEvents}.length === 0 }"
                    class="sapUiMediumMarginTop" />
            </VBox>
        </content>

        <endButton>
            <Button
                text="Close"
                press=".onCancelDialog" />
        </endButton>
    </Dialog>

</core:FragmentDefinition>
