<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:f="sap.f"
    xmlns:card="sap.f.cards"
    xmlns:layout="sap.ui.layout">

    <VBox class="sapUiSmallMargin">
        <!-- KPI Cards Row -->
        <layout:HorizontalLayout allowWrapping="true" class="sapUiMediumMarginBottom">
            <!-- Total Jobs Card -->
            <f:Card class="sapUiSmallMarginEnd" width="200px">
                <f:header>
                    <card:Header
                        title="{i18n>totalJobs}"
                        subtitle="{i18n>allStatuses}" />
                </f:header>
                <f:content>
                    <NumericContent
                        value="{dashboard>/jobsKPI/totalJobs}"
                        scale=""
                        valueColor="Neutral"
                        icon="sap-icon://factory"
                        class="sapUiSmallMargin"
                        press=".onJobsKPICardPress" />
                </f:content>
            </f:Card>

            <!-- Published Jobs Card -->
            <f:Card class="sapUiSmallMarginEnd" width="200px">
                <f:header>
                    <card:Header
                        title="{i18n>publishedJobs}"
                        subtitle="{i18n>activeHiring}" />
                </f:header>
                <f:content>
                    <NumericContent
                        value="{dashboard>/jobsKPI/publishedJobs}"
                        scale=""
                        valueColor="Good"
                        icon="sap-icon://accept"
                        class="sapUiSmallMargin"
                        press=".onJobsKPIPublishedPress" />
                </f:content>
            </f:Card>

            <!-- Jobs with Hot Candidates Card -->
            <f:Card class="sapUiSmallMarginEnd" width="200px">
                <f:header>
                    <card:Header
                        title="{i18n>jobsWithHotCandidates}"
                        subtitle="{i18n>readyToReview}" />
                </f:header>
                <f:content>
                    <NumericContent
                        value="{dashboard>/jobsKPI/jobsWithHotCandidates}"
                        scale=""
                        valueColor="Good"
                        icon="sap-icon://status-positive"
                        class="sapUiSmallMargin"
                        press=".onJobsKPIHotPress" />
                </f:content>
            </f:Card>

            <!-- Jobs Needing Matches Card -->
            <f:Card width="200px">
                <f:header>
                    <card:Header
                        title="{i18n>jobsNeedingMatches}"
                        subtitle="{i18n>noMatchesYet}" />
                </f:header>
                <f:content>
                    <NumericContent
                        value="{dashboard>/jobsKPI/jobsNeedingMatches}"
                        scale=""
                        valueColor="Critical"
                        icon="sap-icon://alert"
                        class="sapUiSmallMargin"
                        press=".onJobsKPINeedingMatchesPress" />
                </f:content>
            </f:Card>
        </layout:HorizontalLayout>

        <!-- Header with Search and Actions -->
        <Toolbar>
            <Title text="{i18n>jobPostings}" level="H2" />
            <ToolbarSpacer />
            <SearchField
                id="jobSearchField"
                width="300px"
                placeholder="{i18n>searchJobs}"
                search=".onJobSearch" />
            <Button
                id="createJobButton"
                text="{i18n>createJob}"
                icon="sap-icon://add"
                type="Emphasized"
                press=".onCreateJob" />
        </Toolbar>

        <!-- Status Filter Chips -->
        <Toolbar class="sapUiTinyMarginTop">
            <Label text="{i18n>filterByStatus}" />
            <SegmentedButton
                id="jobStatusFilterSegment"
                selectionChange=".onJobStatusFilterChange"
                selectedKey="all">
                <items>
                    <SegmentedButtonItem key="all" text="{i18n>triageAll}" />
                    <SegmentedButtonItem key="draft" text="{i18n>statusDraft}" />
                    <SegmentedButtonItem key="published" text="{i18n>statusPublished}" />
                    <SegmentedButtonItem key="closed" text="{i18n>statusClosed}" />
                </items>
            </SegmentedButton>
            <ToolbarSpacer />
            <Label text="{i18n>department}" class="sapUiMediumMarginBegin" />
            <ComboBox
                id="departmentFilter"
                width="200px"
                selectionChange=".onDepartmentFilterChange"
                placeholder="{i18n>allDepartments}">
                <items>
                    <core:Item key="" text="{i18n>allDepartments}" />
                    <core:Item key="Engineering" text="Engineering" />
                    <core:Item key="Sales" text="Sales" />
                    <core:Item key="Marketing" text="Marketing" />
                    <core:Item key="HR" text="Human Resources" />
                    <core:Item key="Finance" text="Finance" />
                </items>
            </ComboBox>
        </Toolbar>

        <!-- Jobs Table -->
        <Table
            id="jobsTable"
            items="{dashboard>/jobsList}"
            growing="true"
            growingScrollToLoad="true"
            growingThreshold="20"
            class="sapUiSmallMarginTop">

            <headerToolbar>
                <OverflowToolbar>
                    <Title text="{i18n>jobPostings}" level="H3" />
                    <ToolbarSpacer />
                    <OverflowToolbarButton
                        icon="sap-icon://refresh"
                        tooltip="{i18n>refresh}"
                        press=".onRefreshJobs" />
                </OverflowToolbar>
            </headerToolbar>

            <columns>
                <Column width="15em">
                    <Text text="{i18n>jobTitle}" />
                </Column>
                <Column width="8em" minScreenWidth="Tablet" demandPopin="true">
                    <Text text="{i18n>department}" />
                </Column>
                <Column width="8em" minScreenWidth="Tablet" demandPopin="true">
                    <Text text="{i18n>location}" />
                </Column>
                <Column width="7em" minScreenWidth="Desktop" demandPopin="true">
                    <Text text="{i18n>status}" />
                </Column>
                <Column width="5em" minScreenWidth="Desktop" demandPopin="true" hAlign="Center">
                    <Text text="{i18n>hotLabel}" />
                </Column>
                <Column width="5em" minScreenWidth="Desktop" demandPopin="true" hAlign="Center">
                    <Text text="{i18n>warmLabel}" />
                </Column>
                <Column width="7em" minScreenWidth="Desktop" demandPopin="true" hAlign="Center">
                    <Text text="{i18n>topMatch}" />
                </Column>
                <Column width="10em" hAlign="End">
                    <Text text="{i18n>actions}" />
                </Column>
            </columns>

            <items>
                <ColumnListItem type="Navigation" press=".onJobPress">
                    <cells>
                        <!-- Job Title -->
                        <VBox>
                            <Text text="{dashboard>title}" class="sapUiTinyMarginBottom" />
                            <Text text="{dashboard>employmentType}" class="sapUiTinyText" />
                        </VBox>

                        <!-- Department -->
                        <Text text="{dashboard>department}" />

                        <!-- Location -->
                        <Text text="{dashboard>location}" />

                        <!-- Status -->
                        <ObjectStatus
                            text="{dashboard>status}"
                            state="{
                                path: 'dashboard>status',
                                formatter: '.StatusFormatter.formatJobStatusState'
                            }" />

                        <!-- Hot Count -->
                        <ObjectStatus
                            text="{dashboard>hotCount}"
                            state="Success"
                            icon="sap-icon://status-positive"
                            visible="{= ${dashboard>hotCount} > 0 }" />

                        <!-- Warm Count -->
                        <ObjectStatus
                            text="{dashboard>warmCount}"
                            state="Warning"
                            icon="sap-icon://status-critical"
                            visible="{= ${dashboard>warmCount} > 0 }" />

                        <!-- Top Match Score -->
                        <HBox alignItems="Center" justifyContent="Center">
                            <ObjectNumber
                                number="{dashboard>topMatchScore}"
                                unit="%"
                                state="{
                                    path: 'dashboard>topMatchScore',
                                    formatter: '.StatusFormatter.formatScoreState'
                                }"
                                visible="{= ${dashboard>topMatchScore} > 0 }" />
                            <Text text="-" visible="{= !${dashboard>topMatchScore} || ${dashboard>topMatchScore} === 0 }" />
                        </HBox>

                        <!-- Actions -->
                        <HBox justifyContent="End">
                            <Button
                                text="{i18n>review}"
                                type="Emphasized"
                                press=".onReviewJobCandidates"
                                visible="{= ${dashboard>hotCount} > 0 }"
                                tooltip="{i18n>reviewHotCandidates}" />
                            <Button
                                icon="sap-icon://match"
                                type="Transparent"
                                press=".onRunJobMatching"
                                tooltip="{i18n>runMatching}" />
                            <Button
                                icon="sap-icon://edit"
                                type="Transparent"
                                press=".onEditJob"
                                tooltip="{i18n>editJob}" />
                        </HBox>
                    </cells>
                </ColumnListItem>
            </items>
        </Table>
    </VBox>

</core:FragmentDefinition>
