<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core">

    <VBox class="sapUiSmallMargin">
        <!-- Header with Search and Actions -->
        <Toolbar>
            <Title text="Job Postings" level="H2" />
            <ToolbarSpacer />
            <SearchField
                id="jobSearchField"
                width="300px"
                placeholder="Search jobs..."
                search=".onJobSearch" />
            <Button
                id="createJobButton"
                text="Create Job"
                icon="sap-icon://add"
                type="Emphasized"
                press=".onCreateJob" />
        </Toolbar>

        <!-- Status Filter Chips -->
        <Toolbar class="sapUiTinyMarginTop">
            <Label text="Filter by Status:" />
            <SegmentedButton
                id="jobStatusFilterSegment"
                selectionChange=".onJobStatusFilterChange">
                <items>
                    <SegmentedButtonItem key="all" text="All" />
                    <SegmentedButtonItem key="draft" text="Draft" />
                    <SegmentedButtonItem key="published" text="Published" />
                    <SegmentedButtonItem key="closed" text="Closed" />
                </items>
            </SegmentedButton>
            <ToolbarSpacer />
            <Label text="Department:" class="sapUiMediumMarginBegin" />
            <ComboBox
                id="departmentFilter"
                width="200px"
                selectionChange=".onDepartmentFilterChange"
                placeholder="All Departments">
                <items>
                    <core:Item key="" text="All Departments" />
                    <core:Item key="Engineering" text="Engineering" />
                    <core:Item key="Sales" text="Sales" />
                    <core:Item key="Marketing" text="Marketing" />
                    <core:Item key="HR" text="Human Resources" />
                    <core:Item key="Finance" text="Finance" />
                </items>
            </ComboBox>
        </Toolbar>

        <!-- Jobs Table -->
        <Table
            id="jobsTable"
            items="{
                path: '/JobPostings',
                parameters: {
                    $expand: 'requiredSkills($expand=skill)'
                }
            }"
            growing="true"
            growingScrollToLoad="true"
            growingThreshold="20"
            class="sapUiSmallMarginTop">

            <headerToolbar>
                <OverflowToolbar>
                    <Title text="Job Postings" level="H3" />
                    <ToolbarSpacer />
                    <OverflowToolbarButton
                        icon="sap-icon://refresh"
                        tooltip="Refresh"
                        press=".onRefreshJobs" />
                </OverflowToolbar>
            </headerToolbar>

            <columns>
                <Column width="15em">
                    <Text text="Job Title" />
                </Column>
                <Column width="10em" minScreenWidth="Tablet" demandPopin="true">
                    <Text text="Department" />
                </Column>
                <Column width="10em" minScreenWidth="Tablet" demandPopin="true">
                    <Text text="Location" />
                </Column>
                <Column width="8em" minScreenWidth="Desktop" demandPopin="true">
                    <Text text="Status" />
                </Column>
                <Column width="8em" minScreenWidth="Desktop" demandPopin="true" hAlign="Center">
                    <Text text="Applications" />
                </Column>
                <Column width="8em" minScreenWidth="Desktop" demandPopin="true" hAlign="Center">
                    <Text text="Top Match" />
                </Column>
                <Column width="12em" hAlign="End">
                    <Text text="Actions" />
                </Column>
            </columns>

            <items>
                <ColumnListItem type="Navigation" press=".onJobPress">
                    <cells>
                        <!-- Job Title -->
                        <VBox>
                            <Text text="{title}" class="sapUiTinyMarginBottom" />
                            <Text text="{employmentType}" class="sapUiTinyText" />
                        </VBox>

                        <!-- Department -->
                        <Text text="{department}" />

                        <!-- Location -->
                        <Text text="{location}" />

                        <!-- Status -->
                        <ObjectStatus
                            text="{status}"
                            state="{
                                path: 'status',
                                formatter: '.StatusFormatter.formatJobStatusState'
                            }" />

                        <!-- Applications Count -->
                        <ObjectNumber
                            number="{applicationCount}"
                            emphasized="false" />

                        <!-- Top Match Score -->
                        <Text text="-" />

                        <!-- Actions -->
                        <HBox justifyContent="End">
                            <Button
                                text="Find Candidates"
                                type="Emphasized"
                                press=".onFindCandidates"
                                tooltip="Find matching candidates" />
                            <Button
                                icon="sap-icon://settings"
                                type="Transparent"
                                press=".onManageScoring"
                                tooltip="Manage Scoring Criteria" />
                            <Button
                                icon="sap-icon://edit"
                                type="Transparent"
                                press=".onEditJob"
                                tooltip="Edit Job" />
                        </HBox>
                    </cells>
                </ColumnListItem>
            </items>
        </Table>
    </VBox>

</core:FragmentDefinition>
