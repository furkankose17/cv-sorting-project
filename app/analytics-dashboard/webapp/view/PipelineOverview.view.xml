<?xml version="1.0" encoding="UTF-8"?>
<mvc:View
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:f="sap.f"
    xmlns:l="sap.ui.layout"
    controllerName="cv.sorting.analytics.controller.PipelineOverview">

    <f:DynamicPage id="pipelinePage" busy="{pipeline>/isLoading}">
        <f:title>
            <f:DynamicPageTitle id="pipelinePageTitle">
                <f:heading>
                    <Title id="pipelineTitle" text="{i18n>pipelineOverviewTitle}" />
                </f:heading>
                <f:snappedContent>
                    <ObjectNumber
                        id="pipelineSummarySnapped"
                        number="{pipeline>/totalCandidates}"
                        unit="{i18n>totalCandidates}" />
                </f:snappedContent>
                <f:actions>
                    <Button id="btnRefreshPipeline" icon="sap-icon://refresh" press="onRefresh" tooltip="{i18n>btnRefresh}" />
                </f:actions>
                <f:navigationActions>
                    <Button id="btnBackPipeline" icon="sap-icon://nav-back" press="onNavBack" tooltip="{i18n>btnBack}" />
                </f:navigationActions>
            </f:DynamicPageTitle>
        </f:title>
        <f:header>
            <f:DynamicPageHeader id="pipelinePageHeader" pinnable="true">
                <f:content>
                    <HBox id="pipelineSummaryBox" justifyContent="SpaceAround" width="100%">
                        <VBox id="totalCandidatesBox" alignItems="Center" class="sapUiSmallMargin">
                            <ObjectNumber id="totalCandidatesNum" number="{pipeline>/totalCandidates}" emphasized="true" />
                            <Label id="totalCandidatesLabel" text="{i18n>totalCandidates}" />
                        </VBox>
                        <VBox id="avgTimeBox" alignItems="Center" class="sapUiSmallMargin">
                            <ObjectNumber id="avgTimeNum" number="{pipeline>/avgTimeToHire}" unit="{i18n>days}" />
                            <Label id="avgTimeLabel" text="{i18n>avgTimeToHire}" />
                        </VBox>
                    </HBox>
                </f:content>
            </f:DynamicPageHeader>
        </f:header>
        <f:content>
            <VBox id="pipelineContent" class="sapUiResponsiveContentPadding">
                <!-- Pipeline Stages -->
                <Panel id="stagesPanel" headerText="{i18n>candidatesByStage}" class="sapUiSmallMarginBottom">
                    <content>
                        <List id="stagesList" items="{pipeline>/stages}" mode="SingleSelectMaster" itemPress="onStagePress">
                            <items>
                                <ObjectListItem
                                    id="stageItem"
                                    title="{pipeline>status}"
                                    number="{pipeline>count}"
                                    numberUnit="{i18n>candidates}"
                                    icon="{pipeline>icon}">
                                    <attributes>
                                        <ObjectAttribute id="stagePercentage" text="{pipeline>percentage}% of total" />
                                    </attributes>
                                    <firstStatus>
                                        <ObjectStatus id="stageStatus" text="{pipeline>percentage}%" state="{pipeline>state}" />
                                    </firstStatus>
                                </ObjectListItem>
                            </items>
                        </List>
                    </content>
                </Panel>

                <!-- Conversion Rates -->
                <Panel id="conversionPanel" headerText="{i18n>conversionRates}" class="sapUiSmallMarginBottom">
                    <content>
                        <List id="conversionList" items="{pipeline>/conversionRates}" noDataText="{i18n>noConversionData}">
                            <items>
                                <StandardListItem
                                    id="conversionItem"
                                    title="{pipeline>from} â†’ {pipeline>to}"
                                    info="{pipeline>rateText}"
                                    infoState="None"
                                    icon="sap-icon://process" />
                            </items>
                        </List>
                    </content>
                </Panel>

                <!-- Sources -->
                <Panel id="sourcesPanel" headerText="{i18n>candidatesBySource}">
                    <content>
                        <List id="sourcesList" items="{pipeline>/bySource}" noDataText="{i18n>noSourceData}">
                            <items>
                                <StandardListItem
                                    id="sourceItem"
                                    title="{pipeline>source}"
                                    description="{pipeline>count} candidates ({pipeline>percentage}%)"
                                    icon="sap-icon://source" />
                            </items>
                        </List>
                    </content>
                </Panel>
            </VBox>
        </f:content>
    </f:DynamicPage>
</mvc:View>
