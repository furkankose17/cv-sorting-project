<?xml version="1.0" encoding="UTF-8" ?>
<mvc:View
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:f="sap.f"
    xmlns:core="sap.ui.core"
    xmlns:form="sap.ui.layout.form"
    xmlns:l="sap.ui.layout"
    controllerName="cv.sorting.jobs.controller.ScoringCriteria"
    displayBlock="true">

    <Page
        id="scoringCriteriaPage"
        title="{i18n>scoringCriteriaTitle}"
        showNavButton="true"
        navButtonPress="onNavBack">
        <headerContent>
            <Button
                id="refreshBtn"
                icon="sap-icon://refresh"
                tooltip="{i18n>refresh}"
                press="onRefresh"/>
            <Button
                id="saveBtn"
                text="{i18n>save}"
                type="Emphasized"
                press="onSave"/>
        </headerContent>

        <content>
            <IconTabBar
                id="criteriaTabBar"
                expanded="true"
                expandable="false">

                <!-- Skills Criteria Tab -->
                <items>
                    <IconTabFilter
                        id="skillsTab"
                        text="{i18n>skills}"
                        icon="sap-icon://education"
                        count="{view>/skillsCriteriaCount}">
                        <VBox class="sapUiSmallMargin">
                            <Toolbar>
                                <Title text="{i18n>skillCriteria}" level="H4"/>
                                <ToolbarSpacer/>
                                <Button
                                    text="{i18n>addSkillCriterion}"
                                    icon="sap-icon://add"
                                    press="onAddSkillCriterion"/>
                            </Toolbar>
                            <Table
                                id="skillsCriteriaTable"
                                items="{view>/skillsCriteria}"
                                mode="Delete"
                                delete="onDeleteCriterion"
                                noDataText="{i18n>noSkillCriteriaConfigured}">
                                <headerToolbar>
                                    <OverflowToolbar>
                                        <SearchField
                                            width="20rem"
                                            search="onSearchSkills"
                                            placeholder="{i18n>searchSkills}"/>
                                    </OverflowToolbar>
                                </headerToolbar>
                                <columns>
                                    <Column width="30%">
                                        <Text text="{i18n>skill}"/>
                                    </Column>
                                    <Column width="15%">
                                        <Text text="{i18n>points}"/>
                                    </Column>
                                    <Column width="15%">
                                        <Text text="{i18n>weight}"/>
                                    </Column>
                                    <Column width="15%">
                                        <Text text="{i18n>required}"/>
                                    </Column>
                                    <Column width="25%">
                                        <Text text="{i18n>actions}"/>
                                    </Column>
                                </columns>
                                <items>
                                    <ColumnListItem>
                                        <cells>
                                            <Text text="{view>criteriaValue}"/>
                                            <Input
                                                value="{view>points}"
                                                type="Number"
                                                width="5rem"
                                                liveChange="onCriteriaChange"/>
                                            <Input
                                                value="{view>weight}"
                                                type="Number"
                                                width="5rem"
                                                liveChange="onCriteriaChange"/>
                                            <Switch
                                                state="{view>isRequired}"
                                                change="onCriteriaChange"/>
                                            <HBox>
                                                <Button
                                                    icon="sap-icon://edit"
                                                    type="Transparent"
                                                    press="onEditCriterion"/>
                                            </HBox>
                                        </cells>
                                    </ColumnListItem>
                                </items>
                            </Table>
                        </VBox>
                    </IconTabFilter>

                    <!-- Experience Criteria Tab -->
                    <IconTabFilter
                        id="experienceTab"
                        text="{i18n>experience}"
                        icon="sap-icon://time-account"
                        count="{view>/experienceCriteriaCount}">
                        <VBox class="sapUiSmallMargin">
                            <Toolbar>
                                <Title text="{i18n>experienceCriteria}" level="H4"/>
                                <ToolbarSpacer/>
                                <Button
                                    text="{i18n>addExperienceCriterion}"
                                    icon="sap-icon://add"
                                    press="onAddExperienceCriterion"/>
                            </Toolbar>
                            <Table
                                id="experienceCriteriaTable"
                                items="{view>/experienceCriteria}"
                                mode="Delete"
                                delete="onDeleteCriterion"
                                noDataText="{i18n>noExperienceCriteriaConfigured}">
                                <columns>
                                    <Column width="20%">
                                        <Text text="{i18n>minimumYears}"/>
                                    </Column>
                                    <Column width="15%">
                                        <Text text="{i18n>basePoints}"/>
                                    </Column>
                                    <Column width="15%">
                                        <Text text="{i18n>pointsPerYear}"/>
                                    </Column>
                                    <Column width="15%">
                                        <Text text="{i18n>maxPoints}"/>
                                    </Column>
                                    <Column width="15%">
                                        <Text text="{i18n>required}"/>
                                    </Column>
                                    <Column width="20%">
                                        <Text text="{i18n>actions}"/>
                                    </Column>
                                </columns>
                                <items>
                                    <ColumnListItem>
                                        <cells>
                                            <Input
                                                value="{view>minValue}"
                                                type="Number"
                                                width="5rem"/>
                                            <Input
                                                value="{view>points}"
                                                type="Number"
                                                width="5rem"/>
                                            <Input
                                                value="{view>perUnitPoints}"
                                                type="Number"
                                                width="5rem"/>
                                            <Input
                                                value="{view>maxPoints}"
                                                type="Number"
                                                width="5rem"/>
                                            <Switch state="{view>isRequired}"/>
                                            <HBox>
                                                <Button
                                                    icon="sap-icon://delete"
                                                    type="Transparent"
                                                    press="onDeleteCriterion"/>
                                            </HBox>
                                        </cells>
                                    </ColumnListItem>
                                </items>
                            </Table>
                        </VBox>
                    </IconTabFilter>

                    <!-- Languages Criteria Tab -->
                    <IconTabFilter
                        id="languagesTab"
                        text="{i18n>languages}"
                        icon="sap-icon://world"
                        count="{view>/languageCriteriaCount}">
                        <VBox class="sapUiSmallMargin">
                            <Toolbar>
                                <Title text="{i18n>languageCriteria}" level="H4"/>
                                <ToolbarSpacer/>
                                <Button
                                    text="{i18n>addLanguageCriterion}"
                                    icon="sap-icon://add"
                                    press="onAddLanguageCriterion"/>
                            </Toolbar>
                            <Table
                                id="languageCriteriaTable"
                                items="{view>/languageCriteria}"
                                mode="Delete"
                                delete="onDeleteCriterion"
                                noDataText="{i18n>noLanguageCriteriaConfigured}">
                                <columns>
                                    <Column width="30%">
                                        <Text text="{i18n>language}"/>
                                    </Column>
                                    <Column width="20%">
                                        <Text text="{i18n>points}"/>
                                    </Column>
                                    <Column width="20%">
                                        <Text text="{i18n>weight}"/>
                                    </Column>
                                    <Column width="15%">
                                        <Text text="{i18n>required}"/>
                                    </Column>
                                    <Column width="15%">
                                        <Text text="{i18n>actions}"/>
                                    </Column>
                                </columns>
                                <items>
                                    <ColumnListItem>
                                        <cells>
                                            <Text text="{view>criteriaValue}"/>
                                            <Input
                                                value="{view>points}"
                                                type="Number"
                                                width="5rem"/>
                                            <Input
                                                value="{view>weight}"
                                                type="Number"
                                                width="5rem"/>
                                            <Switch state="{view>isRequired}"/>
                                            <HBox>
                                                <Button
                                                    icon="sap-icon://edit"
                                                    type="Transparent"
                                                    press="onEditCriterion"/>
                                            </HBox>
                                        </cells>
                                    </ColumnListItem>
                                </items>
                            </Table>
                        </VBox>
                    </IconTabFilter>

                    <!-- Education Criteria Tab -->
                    <IconTabFilter
                        id="educationTab"
                        text="{i18n>education}"
                        icon="sap-icon://education"
                        count="{view>/educationCriteriaCount}">
                        <VBox class="sapUiSmallMargin">
                            <Toolbar>
                                <Title text="{i18n>educationCriteria}" level="H4"/>
                                <ToolbarSpacer/>
                                <Button
                                    text="{i18n>addEducationCriterion}"
                                    icon="sap-icon://add"
                                    press="onAddEducationCriterion"/>
                            </Toolbar>
                            <Table
                                id="educationCriteriaTable"
                                items="{view>/educationCriteria}"
                                mode="Delete"
                                delete="onDeleteCriterion"
                                noDataText="{i18n>noEducationCriteriaConfigured}">
                                <columns>
                                    <Column width="40%">
                                        <Text text="{i18n>educationLevel}"/>
                                    </Column>
                                    <Column width="20%">
                                        <Text text="{i18n>points}"/>
                                    </Column>
                                    <Column width="20%">
                                        <Text text="{i18n>required}"/>
                                    </Column>
                                    <Column width="20%">
                                        <Text text="{i18n>actions}"/>
                                    </Column>
                                </columns>
                                <items>
                                    <ColumnListItem>
                                        <cells>
                                            <Select
                                                selectedKey="{view>criteriaValue}"
                                                forceSelection="false">
                                                <core:Item key="high_school" text="{i18n>highSchool}"/>
                                                <core:Item key="associate" text="{i18n>associate}"/>
                                                <core:Item key="bachelor" text="{i18n>bachelor}"/>
                                                <core:Item key="master" text="{i18n>master}"/>
                                                <core:Item key="doctorate" text="{i18n>doctorate}"/>
                                            </Select>
                                            <Input
                                                value="{view>points}"
                                                type="Number"
                                                width="5rem"/>
                                            <Switch state="{view>isRequired}"/>
                                            <HBox>
                                                <Button
                                                    icon="sap-icon://delete"
                                                    type="Transparent"
                                                    press="onDeleteCriterion"/>
                                            </HBox>
                                        </cells>
                                    </ColumnListItem>
                                </items>
                            </Table>
                        </VBox>
                    </IconTabFilter>

                    <!-- Certifications Tab -->
                    <IconTabFilter
                        id="certificationsTab"
                        text="{i18n>certifications}"
                        icon="sap-icon://badge"
                        count="{view>/certificationCriteriaCount}">
                        <VBox class="sapUiSmallMargin">
                            <Toolbar>
                                <Title text="{i18n>certificationCriteria}" level="H4"/>
                                <ToolbarSpacer/>
                                <Button
                                    text="{i18n>addCertificationCriterion}"
                                    icon="sap-icon://add"
                                    press="onAddCertificationCriterion"/>
                            </Toolbar>
                            <Table
                                id="certificationCriteriaTable"
                                items="{view>/certificationCriteria}"
                                mode="Delete"
                                delete="onDeleteCriterion"
                                noDataText="{i18n>noCertificationCriteriaConfigured}">
                                <columns>
                                    <Column width="40%">
                                        <Text text="{i18n>certification}"/>
                                    </Column>
                                    <Column width="20%">
                                        <Text text="{i18n>points}"/>
                                    </Column>
                                    <Column width="20%">
                                        <Text text="{i18n>required}"/>
                                    </Column>
                                    <Column width="20%">
                                        <Text text="{i18n>actions}"/>
                                    </Column>
                                </columns>
                                <items>
                                    <ColumnListItem>
                                        <cells>
                                            <Text text="{view>criteriaValue}"/>
                                            <Input
                                                value="{view>points}"
                                                type="Number"
                                                width="5rem"/>
                                            <Switch state="{view>isRequired}"/>
                                            <HBox>
                                                <Button
                                                    icon="sap-icon://edit"
                                                    type="Transparent"
                                                    press="onEditCriterion"/>
                                            </HBox>
                                        </cells>
                                    </ColumnListItem>
                                </items>
                            </Table>
                        </VBox>
                    </IconTabFilter>

                    <!-- Templates Tab -->
                    <IconTabFilter
                        id="templatesTab"
                        text="{i18n>templates}"
                        icon="sap-icon://document">
                        <VBox class="sapUiSmallMargin">
                            <MessageStrip
                                text="{i18n>templatesHelpText}"
                                type="Information"
                                showIcon="true"
                                class="sapUiSmallMarginBottom"/>
                            <List
                                id="templatesList"
                                items="{view>/templates}"
                                mode="SingleSelectMaster"
                                selectionChange="onTemplateSelect">
                                <StandardListItem
                                    title="{view>name}"
                                    description="{view>description}"
                                    icon="sap-icon://document-text"
                                    type="Active"/>
                            </List>
                            <Button
                                text="{i18n>applyTemplate}"
                                type="Emphasized"
                                press="onApplyTemplate"
                                class="sapUiSmallMarginTop"/>
                        </VBox>
                    </IconTabFilter>
                </items>
            </IconTabBar>

            <!-- Score Preview Panel -->
            <Panel
                id="previewPanel"
                headerText="{i18n>scorePreview}"
                expandable="true"
                expanded="false"
                class="sapUiSmallMargin">
                <form:SimpleForm
                    editable="false"
                    layout="ResponsiveGridLayout"
                    columnsL="2"
                    columnsM="2">
                    <form:content>
                        <Label text="{i18n>totalMaxPoints}"/>
                        <Text text="{view>/totalMaxPoints}"/>
                        <Label text="{i18n>requiredCriteriaCount}"/>
                        <Text text="{view>/requiredCriteriaCount}"/>
                        <Label text="{i18n>semanticWeight}"/>
                        <Slider
                            value="{view>/semanticWeight}"
                            min="0"
                            max="100"
                            step="5"
                            enableTickmarks="true"
                            showAdvancedTooltip="true"/>
                        <Label text="{i18n>criteriaWeight}"/>
                        <Slider
                            value="{view>/criteriaWeight}"
                            min="0"
                            max="100"
                            step="5"
                            enableTickmarks="true"
                            showAdvancedTooltip="true"/>
                    </form:content>
                </form:SimpleForm>
            </Panel>
        </content>
    </Page>
</mvc:View>
